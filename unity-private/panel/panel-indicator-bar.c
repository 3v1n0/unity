/* panel-indicator-bar.c generated by valac, the Vala compiler
 * generated from panel-indicator-bar.vala, do not modify */

/*
 * Copyright (C) 2010 Canonical Ltd
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 3 as
 * published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Authored by: Neil Jagdish Patel <neil.patel@canonical.com>
 *              Jay Taoko <jay.taoko@canonical.com>
 *
 */

#include <glib.h>
#include <glib-object.h>
#include <clutk/clutk.h>
#include <gee.h>
#include <gtk/gtk.h>
#include <libindicator/indicator-object.h>
#include <stdlib.h>
#include <string.h>
#include <clutter/clutter.h>


#define UNITY_PANEL_INDICATORS_TYPE_INDICATOR_BAR (unity_panel_indicators_indicator_bar_get_type ())
#define UNITY_PANEL_INDICATORS_INDICATOR_BAR(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), UNITY_PANEL_INDICATORS_TYPE_INDICATOR_BAR, UnityPanelIndicatorsIndicatorBar))
#define UNITY_PANEL_INDICATORS_INDICATOR_BAR_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), UNITY_PANEL_INDICATORS_TYPE_INDICATOR_BAR, UnityPanelIndicatorsIndicatorBarClass))
#define UNITY_PANEL_INDICATORS_IS_INDICATOR_BAR(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), UNITY_PANEL_INDICATORS_TYPE_INDICATOR_BAR))
#define UNITY_PANEL_INDICATORS_IS_INDICATOR_BAR_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), UNITY_PANEL_INDICATORS_TYPE_INDICATOR_BAR))
#define UNITY_PANEL_INDICATORS_INDICATOR_BAR_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), UNITY_PANEL_INDICATORS_TYPE_INDICATOR_BAR, UnityPanelIndicatorsIndicatorBarClass))

typedef struct _UnityPanelIndicatorsIndicatorBar UnityPanelIndicatorsIndicatorBar;
typedef struct _UnityPanelIndicatorsIndicatorBarClass UnityPanelIndicatorsIndicatorBarClass;
typedef struct _UnityPanelIndicatorsIndicatorBarPrivate UnityPanelIndicatorsIndicatorBarPrivate;

#define UNITY_PANEL_INDICATORS_TYPE_INDICATOR_OBJECT_VIEW (unity_panel_indicators_indicator_object_view_get_type ())
#define UNITY_PANEL_INDICATORS_INDICATOR_OBJECT_VIEW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), UNITY_PANEL_INDICATORS_TYPE_INDICATOR_OBJECT_VIEW, UnityPanelIndicatorsIndicatorObjectView))
#define UNITY_PANEL_INDICATORS_INDICATOR_OBJECT_VIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), UNITY_PANEL_INDICATORS_TYPE_INDICATOR_OBJECT_VIEW, UnityPanelIndicatorsIndicatorObjectViewClass))
#define UNITY_PANEL_INDICATORS_IS_INDICATOR_OBJECT_VIEW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), UNITY_PANEL_INDICATORS_TYPE_INDICATOR_OBJECT_VIEW))
#define UNITY_PANEL_INDICATORS_IS_INDICATOR_OBJECT_VIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), UNITY_PANEL_INDICATORS_TYPE_INDICATOR_OBJECT_VIEW))
#define UNITY_PANEL_INDICATORS_INDICATOR_OBJECT_VIEW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), UNITY_PANEL_INDICATORS_TYPE_INDICATOR_OBJECT_VIEW, UnityPanelIndicatorsIndicatorObjectViewClass))

typedef struct _UnityPanelIndicatorsIndicatorObjectView UnityPanelIndicatorsIndicatorObjectView;
typedef struct _UnityPanelIndicatorsIndicatorObjectViewClass UnityPanelIndicatorsIndicatorObjectViewClass;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))

#define UNITY_PANEL_INDICATORS_TYPE_INDICATORS_MODEL (unity_panel_indicators_indicators_model_get_type ())
#define UNITY_PANEL_INDICATORS_INDICATORS_MODEL(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), UNITY_PANEL_INDICATORS_TYPE_INDICATORS_MODEL, UnityPanelIndicatorsIndicatorsModel))
#define UNITY_PANEL_INDICATORS_INDICATORS_MODEL_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), UNITY_PANEL_INDICATORS_TYPE_INDICATORS_MODEL, UnityPanelIndicatorsIndicatorsModelClass))
#define UNITY_PANEL_INDICATORS_IS_INDICATORS_MODEL(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), UNITY_PANEL_INDICATORS_TYPE_INDICATORS_MODEL))
#define UNITY_PANEL_INDICATORS_IS_INDICATORS_MODEL_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), UNITY_PANEL_INDICATORS_TYPE_INDICATORS_MODEL))
#define UNITY_PANEL_INDICATORS_INDICATORS_MODEL_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), UNITY_PANEL_INDICATORS_TYPE_INDICATORS_MODEL, UnityPanelIndicatorsIndicatorsModelClass))

typedef struct _UnityPanelIndicatorsIndicatorsModel UnityPanelIndicatorsIndicatorsModel;
typedef struct _UnityPanelIndicatorsIndicatorsModelClass UnityPanelIndicatorsIndicatorsModelClass;
#define _g_free0(var) (var = (g_free (var), NULL))

struct _UnityPanelIndicatorsIndicatorBar {
	CtkBox parent_instance;
	UnityPanelIndicatorsIndicatorBarPrivate * priv;
};

struct _UnityPanelIndicatorsIndicatorBarClass {
	CtkBoxClass parent_class;
};

struct _UnityPanelIndicatorsIndicatorBarPrivate {
	GeeArrayList* indicator_array;
};


static gpointer unity_panel_indicators_indicator_bar_parent_class = NULL;

GType unity_panel_indicators_indicator_bar_get_type (void);
GType unity_panel_indicators_indicator_object_view_get_type (void);
#define UNITY_PANEL_INDICATORS_INDICATOR_BAR_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), UNITY_PANEL_INDICATORS_TYPE_INDICATOR_BAR, UnityPanelIndicatorsIndicatorBarPrivate))
enum  {
	UNITY_PANEL_INDICATORS_INDICATOR_BAR_DUMMY_PROPERTY
};
UnityPanelIndicatorsIndicatorBar* unity_panel_indicators_indicator_bar_new (void);
UnityPanelIndicatorsIndicatorBar* unity_panel_indicators_indicator_bar_construct (GType object_type);
void unity_panel_indicators_indicator_object_view_open_last_menu_entry (UnityPanelIndicatorsIndicatorObjectView* self);
void unity_panel_indicators_indicator_object_view_open_first_menu_entry (UnityPanelIndicatorsIndicatorObjectView* self);
static void unity_panel_indicators_indicator_bar_on_menu_moved (UnityPanelIndicatorsIndicatorBar* self, UnityPanelIndicatorsIndicatorObjectView* object_view, GtkMenuDirectionType type);
GType unity_panel_indicators_indicators_model_get_type (void);
UnityPanelIndicatorsIndicatorsModel* unity_panel_indicators_indicators_model_get_default (void);
GeeArrayList* unity_panel_indicators_indicators_model_get_indicators (UnityPanelIndicatorsIndicatorsModel* self);
char* unity_panel_indicators_indicators_model_get_indicator_name (UnityPanelIndicatorsIndicatorsModel* self, IndicatorObject* o);
UnityPanelIndicatorsIndicatorObjectView* unity_panel_indicators_indicator_object_view_new (IndicatorObject* _object);
UnityPanelIndicatorsIndicatorObjectView* unity_panel_indicators_indicator_object_view_construct (GType object_type, IndicatorObject* _object);
static void _unity_panel_indicators_indicator_bar_on_menu_moved_unity_panel_indicators_indicator_object_view_menu_moved (UnityPanelIndicatorsIndicatorObjectView* _sender, GtkMenuDirectionType type, gpointer self);
static GObject * unity_panel_indicators_indicator_bar_constructor (GType type, guint n_construct_properties, GObjectConstructParam * construct_properties);
static void unity_panel_indicators_indicator_bar_finalize (GObject* obj);
static int _vala_strcmp0 (const char * str1, const char * str2);



#line 27 "panel-indicator-bar.vala"
UnityPanelIndicatorsIndicatorBar* unity_panel_indicators_indicator_bar_construct (GType object_type) {
#line 111 "panel-indicator-bar.c"
	UnityPanelIndicatorsIndicatorBar * self;
#line 29 "panel-indicator-bar.vala"
	self = (UnityPanelIndicatorsIndicatorBar*) g_object_new (object_type, "orientation", CTK_ORIENTATION_HORIZONTAL, "spacing", 0, "homogeneous", FALSE, NULL);
#line 115 "panel-indicator-bar.c"
	return self;
}


#line 27 "panel-indicator-bar.vala"
UnityPanelIndicatorsIndicatorBar* unity_panel_indicators_indicator_bar_new (void) {
#line 27 "panel-indicator-bar.vala"
	return unity_panel_indicators_indicator_bar_construct (UNITY_PANEL_INDICATORS_TYPE_INDICATOR_BAR);
#line 124 "panel-indicator-bar.c"
}


#line 60 "panel-indicator-bar.vala"
static void unity_panel_indicators_indicator_bar_on_menu_moved (UnityPanelIndicatorsIndicatorBar* self, UnityPanelIndicatorsIndicatorObjectView* object_view, GtkMenuDirectionType type) {
#line 130 "panel-indicator-bar.c"
	gint pos;
	UnityPanelIndicatorsIndicatorObjectView* next_object_view;
#line 60 "panel-indicator-bar.vala"
	g_return_if_fail (self != NULL);
#line 60 "panel-indicator-bar.vala"
	g_return_if_fail (object_view != NULL);
#line 63 "panel-indicator-bar.vala"
	pos = gee_abstract_list_index_of ((GeeAbstractList*) self->priv->indicator_array, object_view);
#line 64 "panel-indicator-bar.vala"
	if (pos == (-1)) {
#line 65 "panel-indicator-bar.vala"
		return;
#line 143 "panel-indicator-bar.c"
	}
#line 67 "panel-indicator-bar.vala"
	if (type == GTK_MENU_DIR_PARENT) {
#line 69 "panel-indicator-bar.vala"
		if (pos == 0) {
#line 71 "panel-indicator-bar.vala"
			pos = gee_collection_get_size ((GeeCollection*) self->priv->indicator_array) - 1;
#line 151 "panel-indicator-bar.c"
		} else {
#line 74 "panel-indicator-bar.vala"
			pos = pos - 1;
#line 155 "panel-indicator-bar.c"
		}
	} else {
#line 76 "panel-indicator-bar.vala"
		if (type == GTK_MENU_DIR_CHILD) {
#line 78 "panel-indicator-bar.vala"
			if (pos == (gee_collection_get_size ((GeeCollection*) self->priv->indicator_array) - 1)) {
#line 80 "panel-indicator-bar.vala"
				pos = 0;
#line 164 "panel-indicator-bar.c"
			} else {
#line 83 "panel-indicator-bar.vala"
				pos = pos + 1;
#line 168 "panel-indicator-bar.c"
			}
		}
	}
#line 86 "panel-indicator-bar.vala"
	next_object_view = (UnityPanelIndicatorsIndicatorObjectView*) gee_abstract_list_get ((GeeAbstractList*) self->priv->indicator_array, pos);
#line 88 "panel-indicator-bar.vala"
	if (type == GTK_MENU_DIR_PARENT) {
#line 90 "panel-indicator-bar.vala"
		unity_panel_indicators_indicator_object_view_open_last_menu_entry (next_object_view);
#line 178 "panel-indicator-bar.c"
	}
#line 93 "panel-indicator-bar.vala"
	if (type == GTK_MENU_DIR_CHILD) {
#line 95 "panel-indicator-bar.vala"
		unity_panel_indicators_indicator_object_view_open_first_menu_entry (next_object_view);
#line 184 "panel-indicator-bar.c"
	}
	_g_object_unref0 (next_object_view);
}


#line 60 "panel-indicator-bar.vala"
static void _unity_panel_indicators_indicator_bar_on_menu_moved_unity_panel_indicators_indicator_object_view_menu_moved (UnityPanelIndicatorsIndicatorObjectView* _sender, GtkMenuDirectionType type, gpointer self) {
#line 192 "panel-indicator-bar.c"
	unity_panel_indicators_indicator_bar_on_menu_moved (self, _sender, type);
}


static GObject * unity_panel_indicators_indicator_bar_constructor (GType type, guint n_construct_properties, GObjectConstructParam * construct_properties) {
	GObject * obj;
	GObjectClass * parent_class;
	UnityPanelIndicatorsIndicatorBar * self;
	parent_class = G_OBJECT_CLASS (unity_panel_indicators_indicator_bar_parent_class);
	obj = parent_class->constructor (type, n_construct_properties, construct_properties);
	self = UNITY_PANEL_INDICATORS_INDICATOR_BAR (obj);
	{
		GeeArrayList* _tmp0_;
		UnityPanelIndicatorsIndicatorsModel* model;
		GeeArrayList* indicators_list;
#line 36 "panel-indicator-bar.vala"
		self->priv->indicator_array = (_tmp0_ = gee_array_list_new (UNITY_PANEL_INDICATORS_TYPE_INDICATOR_OBJECT_VIEW, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL), _g_object_unref0 (self->priv->indicator_array), _tmp0_);
#line 38 "panel-indicator-bar.vala"
		model = unity_panel_indicators_indicators_model_get_default ();
#line 39 "panel-indicator-bar.vala"
		indicators_list = unity_panel_indicators_indicators_model_get_indicators (model);
#line 214 "panel-indicator-bar.c"
		{
			GeeIterator* _o_it;
			_o_it = gee_abstract_collection_iterator ((GeeAbstractCollection*) indicators_list);
#line 41 "panel-indicator-bar.vala"
			while (TRUE) {
#line 220 "panel-indicator-bar.c"
				IndicatorObject* o;
				char* name;
#line 41 "panel-indicator-bar.vala"
				if (!gee_iterator_next (_o_it)) {
#line 41 "panel-indicator-bar.vala"
					break;
#line 227 "panel-indicator-bar.c"
				}
#line 41 "panel-indicator-bar.vala"
				o = (IndicatorObject*) gee_iterator_get (_o_it);
#line 43 "panel-indicator-bar.vala"
				name = unity_panel_indicators_indicators_model_get_indicator_name (model, o);
#line 45 "panel-indicator-bar.vala"
				if (_vala_strcmp0 (name, "libappmenu.so") != 0) {
#line 235 "panel-indicator-bar.c"
					UnityPanelIndicatorsIndicatorObjectView* indicator_object_view;
#line 47 "panel-indicator-bar.vala"
					indicator_object_view = g_object_ref_sink (unity_panel_indicators_indicator_object_view_new (o));
#line 48 "panel-indicator-bar.vala"
					g_signal_connect_object (indicator_object_view, "menu-moved", (GCallback) _unity_panel_indicators_indicator_bar_on_menu_moved_unity_panel_indicators_indicator_object_view_menu_moved, self, 0);
#line 49 "panel-indicator-bar.vala"
					gee_abstract_collection_add ((GeeAbstractCollection*) self->priv->indicator_array, indicator_object_view);
#line 51 "panel-indicator-bar.vala"
					clutter_container_add_actor ((ClutterContainer*) self, (ClutterActor*) indicator_object_view);
#line 52 "panel-indicator-bar.vala"
					clutter_actor_show ((ClutterActor*) indicator_object_view);
#line 247 "panel-indicator-bar.c"
					_g_object_unref0 (indicator_object_view);
				}
				_g_object_unref0 (o);
				_g_free0 (name);
			}
			_g_object_unref0 (_o_it);
		}
		_g_object_unref0 (model);
		_g_object_unref0 (indicators_list);
	}
	return obj;
}


static void unity_panel_indicators_indicator_bar_class_init (UnityPanelIndicatorsIndicatorBarClass * klass) {
	unity_panel_indicators_indicator_bar_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (UnityPanelIndicatorsIndicatorBarPrivate));
	G_OBJECT_CLASS (klass)->constructor = unity_panel_indicators_indicator_bar_constructor;
	G_OBJECT_CLASS (klass)->finalize = unity_panel_indicators_indicator_bar_finalize;
}


static void unity_panel_indicators_indicator_bar_instance_init (UnityPanelIndicatorsIndicatorBar * self) {
	self->priv = UNITY_PANEL_INDICATORS_INDICATOR_BAR_GET_PRIVATE (self);
}


static void unity_panel_indicators_indicator_bar_finalize (GObject* obj) {
	UnityPanelIndicatorsIndicatorBar * self;
	self = UNITY_PANEL_INDICATORS_INDICATOR_BAR (obj);
	_g_object_unref0 (self->priv->indicator_array);
	G_OBJECT_CLASS (unity_panel_indicators_indicator_bar_parent_class)->finalize (obj);
}


GType unity_panel_indicators_indicator_bar_get_type (void) {
	static volatile gsize unity_panel_indicators_indicator_bar_type_id__volatile = 0;
	if (g_once_init_enter (&unity_panel_indicators_indicator_bar_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (UnityPanelIndicatorsIndicatorBarClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) unity_panel_indicators_indicator_bar_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (UnityPanelIndicatorsIndicatorBar), 0, (GInstanceInitFunc) unity_panel_indicators_indicator_bar_instance_init, NULL };
		GType unity_panel_indicators_indicator_bar_type_id;
		unity_panel_indicators_indicator_bar_type_id = g_type_register_static (CTK_TYPE_BOX, "UnityPanelIndicatorsIndicatorBar", &g_define_type_info, 0);
		g_once_init_leave (&unity_panel_indicators_indicator_bar_type_id__volatile, unity_panel_indicators_indicator_bar_type_id);
	}
	return unity_panel_indicators_indicator_bar_type_id__volatile;
}


static int _vala_strcmp0 (const char * str1, const char * str2) {
	if (str1 == NULL) {
		return -(str1 != str2);
	}
	if (str2 == NULL) {
		return str1 != str2;
	}
	return strcmp (str1, str2);
}





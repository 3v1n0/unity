/* scroller-controller.c generated by valac, the Vala compiler
 * generated from scroller-controller.vala, do not modify */

/* -*- Mode: vala; indent-tabs-mode: nil; c-basic-offset: 2; tab-width: 2 -*- */
/*
 * Copyright (C) 2009-2010 Canonical Ltd
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 3 as
 * published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Authored by Gordon Allott <gord.allott@canonical.com>
 *
 */

#include <glib.h>
#include <glib-object.h>
#include <clutk/clutk.h>
#include <gee.h>
#include <libbamf/libbamf.h>
#include <unity.h>
#include <stdlib.h>
#include <string.h>
#include <glib/gstdio.h>
#include <float.h>
#include <math.h>
#include <clutter/clutter.h>


#define UNITY_LAUNCHER_TYPE_SCROLLER_CONTROLLER (unity_launcher_scroller_controller_get_type ())
#define UNITY_LAUNCHER_SCROLLER_CONTROLLER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_CONTROLLER, UnityLauncherScrollerController))
#define UNITY_LAUNCHER_SCROLLER_CONTROLLER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), UNITY_LAUNCHER_TYPE_SCROLLER_CONTROLLER, UnityLauncherScrollerControllerClass))
#define UNITY_LAUNCHER_IS_SCROLLER_CONTROLLER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_CONTROLLER))
#define UNITY_LAUNCHER_IS_SCROLLER_CONTROLLER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), UNITY_LAUNCHER_TYPE_SCROLLER_CONTROLLER))
#define UNITY_LAUNCHER_SCROLLER_CONTROLLER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_CONTROLLER, UnityLauncherScrollerControllerClass))

typedef struct _UnityLauncherScrollerController UnityLauncherScrollerController;
typedef struct _UnityLauncherScrollerControllerClass UnityLauncherScrollerControllerClass;
typedef struct _UnityLauncherScrollerControllerPrivate UnityLauncherScrollerControllerPrivate;

#define UNITY_LAUNCHER_TYPE_SCROLLER_MODEL (unity_launcher_scroller_model_get_type ())
#define UNITY_LAUNCHER_SCROLLER_MODEL(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_MODEL, UnityLauncherScrollerModel))
#define UNITY_LAUNCHER_SCROLLER_MODEL_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), UNITY_LAUNCHER_TYPE_SCROLLER_MODEL, UnityLauncherScrollerModelClass))
#define UNITY_LAUNCHER_IS_SCROLLER_MODEL(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_MODEL))
#define UNITY_LAUNCHER_IS_SCROLLER_MODEL_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), UNITY_LAUNCHER_TYPE_SCROLLER_MODEL))
#define UNITY_LAUNCHER_SCROLLER_MODEL_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_MODEL, UnityLauncherScrollerModelClass))

typedef struct _UnityLauncherScrollerModel UnityLauncherScrollerModel;
typedef struct _UnityLauncherScrollerModelClass UnityLauncherScrollerModelClass;

#define UNITY_LAUNCHER_TYPE_SCROLLER_VIEW (unity_launcher_scroller_view_get_type ())
#define UNITY_LAUNCHER_SCROLLER_VIEW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_VIEW, UnityLauncherScrollerView))
#define UNITY_LAUNCHER_SCROLLER_VIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), UNITY_LAUNCHER_TYPE_SCROLLER_VIEW, UnityLauncherScrollerViewClass))
#define UNITY_LAUNCHER_IS_SCROLLER_VIEW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_VIEW))
#define UNITY_LAUNCHER_IS_SCROLLER_VIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), UNITY_LAUNCHER_TYPE_SCROLLER_VIEW))
#define UNITY_LAUNCHER_SCROLLER_VIEW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_VIEW, UnityLauncherScrollerViewClass))

typedef struct _UnityLauncherScrollerView UnityLauncherScrollerView;
typedef struct _UnityLauncherScrollerViewClass UnityLauncherScrollerViewClass;

#define UNITY_LAUNCHER_TYPE_SCROLLER_CHILD_CONTROLLER (unity_launcher_scroller_child_controller_get_type ())
#define UNITY_LAUNCHER_SCROLLER_CHILD_CONTROLLER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_CHILD_CONTROLLER, UnityLauncherScrollerChildController))
#define UNITY_LAUNCHER_SCROLLER_CHILD_CONTROLLER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), UNITY_LAUNCHER_TYPE_SCROLLER_CHILD_CONTROLLER, UnityLauncherScrollerChildControllerClass))
#define UNITY_LAUNCHER_IS_SCROLLER_CHILD_CONTROLLER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_CHILD_CONTROLLER))
#define UNITY_LAUNCHER_IS_SCROLLER_CHILD_CONTROLLER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), UNITY_LAUNCHER_TYPE_SCROLLER_CHILD_CONTROLLER))
#define UNITY_LAUNCHER_SCROLLER_CHILD_CONTROLLER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_CHILD_CONTROLLER, UnityLauncherScrollerChildControllerClass))

typedef struct _UnityLauncherScrollerChildController UnityLauncherScrollerChildController;
typedef struct _UnityLauncherScrollerChildControllerClass UnityLauncherScrollerChildControllerClass;
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))

#define UNITY_LAUNCHER_TYPE_APPLICATION_CONTROLLER (unity_launcher_application_controller_get_type ())
#define UNITY_LAUNCHER_APPLICATION_CONTROLLER(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), UNITY_LAUNCHER_TYPE_APPLICATION_CONTROLLER, UnityLauncherApplicationController))
#define UNITY_LAUNCHER_APPLICATION_CONTROLLER_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), UNITY_LAUNCHER_TYPE_APPLICATION_CONTROLLER, UnityLauncherApplicationControllerClass))
#define UNITY_LAUNCHER_IS_APPLICATION_CONTROLLER(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), UNITY_LAUNCHER_TYPE_APPLICATION_CONTROLLER))
#define UNITY_LAUNCHER_IS_APPLICATION_CONTROLLER_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), UNITY_LAUNCHER_TYPE_APPLICATION_CONTROLLER))
#define UNITY_LAUNCHER_APPLICATION_CONTROLLER_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), UNITY_LAUNCHER_TYPE_APPLICATION_CONTROLLER, UnityLauncherApplicationControllerClass))

typedef struct _UnityLauncherApplicationController UnityLauncherApplicationController;
typedef struct _UnityLauncherApplicationControllerClass UnityLauncherApplicationControllerClass;

#define UNITY_LAUNCHER_TYPE_SCROLLER_CHILD (unity_launcher_scroller_child_get_type ())
#define UNITY_LAUNCHER_SCROLLER_CHILD(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_CHILD, UnityLauncherScrollerChild))
#define UNITY_LAUNCHER_SCROLLER_CHILD_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), UNITY_LAUNCHER_TYPE_SCROLLER_CHILD, UnityLauncherScrollerChildClass))
#define UNITY_LAUNCHER_IS_SCROLLER_CHILD(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_CHILD))
#define UNITY_LAUNCHER_IS_SCROLLER_CHILD_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), UNITY_LAUNCHER_TYPE_SCROLLER_CHILD))
#define UNITY_LAUNCHER_SCROLLER_CHILD_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), UNITY_LAUNCHER_TYPE_SCROLLER_CHILD, UnityLauncherScrollerChildClass))

typedef struct _UnityLauncherScrollerChild UnityLauncherScrollerChild;
typedef struct _UnityLauncherScrollerChildClass UnityLauncherScrollerChildClass;

#define UNITY_LAUNCHER_TYPE_LAUNCHER_CHILD (unity_launcher_launcher_child_get_type ())
#define UNITY_LAUNCHER_LAUNCHER_CHILD(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), UNITY_LAUNCHER_TYPE_LAUNCHER_CHILD, UnityLauncherLauncherChild))
#define UNITY_LAUNCHER_LAUNCHER_CHILD_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), UNITY_LAUNCHER_TYPE_LAUNCHER_CHILD, UnityLauncherLauncherChildClass))
#define UNITY_LAUNCHER_IS_LAUNCHER_CHILD(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), UNITY_LAUNCHER_TYPE_LAUNCHER_CHILD))
#define UNITY_LAUNCHER_IS_LAUNCHER_CHILD_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), UNITY_LAUNCHER_TYPE_LAUNCHER_CHILD))
#define UNITY_LAUNCHER_LAUNCHER_CHILD_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), UNITY_LAUNCHER_TYPE_LAUNCHER_CHILD, UnityLauncherLauncherChildClass))

typedef struct _UnityLauncherLauncherChild UnityLauncherLauncherChild;
typedef struct _UnityLauncherLauncherChildClass UnityLauncherLauncherChildClass;
#define _g_free0(var) (var = (g_free (var), NULL))
typedef struct _UnityLauncherScrollerChildPrivate UnityLauncherScrollerChildPrivate;

#define UNITY_LAUNCHER_TYPE_PIN_TYPE (unity_launcher_pin_type_get_type ())

struct _UnityLauncherScrollerController {
	GObject parent_instance;
	UnityLauncherScrollerControllerPrivate * priv;
};

struct _UnityLauncherScrollerControllerClass {
	GObjectClass parent_class;
};

struct _UnityLauncherScrollerControllerPrivate {
	UnityLauncherScrollerModel* _model;
	UnityLauncherScrollerView* _view;
	GeeArrayList* childcontrollers;
	BamfMatcher* matcher;
	UnityFavorites* favorites;
};

typedef enum  {
	UNITY_LAUNCHER_PIN_TYPE_UNPINNED,
	UNITY_LAUNCHER_PIN_TYPE_PINNED,
	UNITY_LAUNCHER_PIN_TYPE_ALWAYS,
	UNITY_LAUNCHER_PIN_TYPE_NEVER
} UnityLauncherPinType;

struct _UnityLauncherScrollerChild {
	CtkActor parent_instance;
	UnityLauncherScrollerChildPrivate * priv;
	UnityLauncherPinType pin_type;
};

struct _UnityLauncherScrollerChildClass {
	CtkActorClass parent_class;
};


static gpointer unity_launcher_scroller_controller_parent_class = NULL;

GType unity_launcher_scroller_controller_get_type (void);
GType unity_launcher_scroller_model_get_type (void);
GType unity_launcher_scroller_view_get_type (void);
GType unity_launcher_scroller_child_controller_get_type (void);
#define UNITY_LAUNCHER_SCROLLER_CONTROLLER_GET_PRIVATE(o) (G_TYPE_INSTANCE_GET_PRIVATE ((o), UNITY_LAUNCHER_TYPE_SCROLLER_CONTROLLER, UnityLauncherScrollerControllerPrivate))
enum  {
	UNITY_LAUNCHER_SCROLLER_CONTROLLER_DUMMY_PROPERTY,
	UNITY_LAUNCHER_SCROLLER_CONTROLLER_MODEL,
	UNITY_LAUNCHER_SCROLLER_CONTROLLER_VIEW
};
#define UNITY_LAUNCHER_SCROLLER_CONTROLLER_DRAG_SAFE_ZONE ((guint) 300)
UnityLauncherScrollerController* unity_launcher_scroller_controller_new (UnityLauncherScrollerModel* _model, UnityLauncherScrollerView* _view);
UnityLauncherScrollerController* unity_launcher_scroller_controller_construct (GType object_type, UnityLauncherScrollerModel* _model, UnityLauncherScrollerView* _view);
static void unity_launcher_scroller_controller_handle_bamf_view_opened (UnityLauncherScrollerController* self, GObject* object);
static void _lambda17_ (BamfView* a, gboolean changed, UnityLauncherScrollerController* self);
static void __lambda17__bamf_view_user_visible_changed (BamfView* _sender, gboolean object, gpointer self);
GType unity_launcher_application_controller_get_type (void);
static UnityLauncherApplicationController* unity_launcher_scroller_controller_find_controller_by_desktop_file (UnityLauncherScrollerController* self, const char* desktop_file);
void unity_launcher_application_controller_attach_application (UnityLauncherApplicationController* self, BamfApplication* application);
UnityLauncherLauncherChild* unity_launcher_launcher_child_new (void);
UnityLauncherLauncherChild* unity_launcher_launcher_child_construct (GType object_type);
GType unity_launcher_scroller_child_get_type (void);
GType unity_launcher_launcher_child_get_type (void);
UnityLauncherApplicationController* unity_launcher_application_controller_new (const char* desktop_file_, UnityLauncherScrollerChild* child_);
UnityLauncherApplicationController* unity_launcher_application_controller_construct (GType object_type, const char* desktop_file_, UnityLauncherScrollerChild* child_);
UnityLauncherScrollerModel* unity_launcher_scroller_controller_get_model (UnityLauncherScrollerController* self);
void unity_launcher_scroller_model_add (UnityLauncherScrollerModel* self, UnityLauncherScrollerChild* child);
static void unity_launcher_scroller_controller_on_scroller_controller_closed (UnityLauncherScrollerController* self, UnityLauncherScrollerChildController* controller);
static void _unity_launcher_scroller_controller_on_scroller_controller_closed_unity_launcher_scroller_child_controller_closed (UnityLauncherScrollerChildController* _sender, gpointer self);
UnityLauncherScrollerChild* unity_launcher_scroller_child_controller_get_child (UnityLauncherScrollerChildController* self);
GType unity_launcher_pin_type_get_type (void);
void unity_launcher_scroller_model_remove (UnityLauncherScrollerModel* self, UnityLauncherScrollerChild* child);
static void unity_launcher_scroller_controller_build_favorites (UnityLauncherScrollerController* self);
static void unity_launcher_scroller_controller_on_favorite_added (UnityLauncherScrollerController* self, const char* uid);
void unity_launcher_scroller_controller_on_favorite_removed (UnityLauncherScrollerController* self, const char* uid);
gboolean unity_launcher_scroller_controller_desktop_file_is_favorite (UnityLauncherScrollerController* self, const char* desktop_file);
const char* unity_launcher_application_controller_get_desktop_file (UnityLauncherApplicationController* self);
static void unity_launcher_scroller_controller_on_unity_drag_motion (UnityLauncherScrollerController* self, UnityDragModel* drag_model, float x, float y);
static void _unity_launcher_scroller_controller_on_unity_drag_motion_unity_drag_controller_drag_motion (UnityDragController* _sender, UnityDragModel* model, float x, float y, gpointer self);
static void unity_launcher_scroller_controller_on_unity_drag_drop (UnityLauncherScrollerController* self, UnityDragModel* drag_model, float x, float y);
static void _unity_launcher_scroller_controller_on_unity_drag_drop_unity_drag_controller_drag_drop (UnityDragController* _sender, UnityDragModel* model, float x, float y, gpointer self);
UnityLauncherScrollerView* unity_launcher_scroller_controller_get_view (UnityLauncherScrollerController* self);
static void unity_launcher_scroller_controller_on_unity_drag_start (UnityLauncherScrollerController* self, UnityDragModel* drag_model);
gint unity_launcher_scroller_view_get_model_index_at_y_pos (UnityLauncherScrollerView* self, float y);
gboolean unity_launcher_scroller_model_contains (UnityLauncherScrollerModel* self, UnityLauncherScrollerChild* child);
void unity_launcher_scroller_model_move (UnityLauncherScrollerModel* self, UnityLauncherScrollerChild* child, gint i);
void unity_launcher_scroller_model_insert (UnityLauncherScrollerModel* self, UnityLauncherScrollerChild* child, gint i);
static void unity_launcher_scroller_controller_set_model (UnityLauncherScrollerController* self, UnityLauncherScrollerModel* value);
static void unity_launcher_scroller_controller_set_view (UnityLauncherScrollerController* self, UnityLauncherScrollerView* value);
static void _unity_launcher_scroller_controller_on_favorite_added_unity_favorites_favorite_added (UnityFavorites* _sender, const char* uid, gpointer self);
static void _unity_launcher_scroller_controller_handle_bamf_view_opened_bamf_matcher_view_opened (BamfMatcher* _sender, GObject* object, gpointer self);
static void _unity_launcher_scroller_controller_on_unity_drag_start_unity_drag_controller_drag_start (UnityDragController* _sender, UnityDragModel* model, gpointer self);
static GObject * unity_launcher_scroller_controller_constructor (GType type, guint n_construct_properties, GObjectConstructParam * construct_properties);
static void unity_launcher_scroller_controller_finalize (GObject* obj);
static void unity_launcher_scroller_controller_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec);
static void unity_launcher_scroller_controller_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec);
static int _vala_strcmp0 (const char * str1, const char * str2);



#line 37 "scroller-controller.vala"
UnityLauncherScrollerController* unity_launcher_scroller_controller_construct (GType object_type, UnityLauncherScrollerModel* _model, UnityLauncherScrollerView* _view) {
#line 214 "scroller-controller.c"
	UnityLauncherScrollerController * self;
#line 37 "scroller-controller.vala"
	g_return_val_if_fail (_model != NULL, NULL);
#line 37 "scroller-controller.vala"
	g_return_val_if_fail (_view != NULL, NULL);
#line 39 "scroller-controller.vala"
	self = (UnityLauncherScrollerController*) g_object_new (object_type, "model", _model, "view", _view, NULL);
#line 222 "scroller-controller.c"
	return self;
}


#line 37 "scroller-controller.vala"
UnityLauncherScrollerController* unity_launcher_scroller_controller_new (UnityLauncherScrollerModel* _model, UnityLauncherScrollerView* _view) {
#line 37 "scroller-controller.vala"
	return unity_launcher_scroller_controller_construct (UNITY_LAUNCHER_TYPE_SCROLLER_CONTROLLER, _model, _view);
#line 231 "scroller-controller.c"
}


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


#line 83 "scroller-controller.vala"
static void _lambda17_ (BamfView* a, gboolean changed, UnityLauncherScrollerController* self) {
#line 83 "scroller-controller.vala"
	g_return_if_fail (a != NULL);
#line 84 "scroller-controller.vala"
	if (changed) {
#line 246 "scroller-controller.c"
		BamfView* _tmp0_;
#line 86 "scroller-controller.vala"
		unity_launcher_scroller_controller_handle_bamf_view_opened (self, (_tmp0_ = a, G_IS_OBJECT (_tmp0_) ? ((GObject*) _tmp0_) : NULL));
#line 250 "scroller-controller.c"
	}
}


#line 83 "scroller-controller.vala"
static void __lambda17__bamf_view_user_visible_changed (BamfView* _sender, gboolean object, gpointer self) {
#line 257 "scroller-controller.c"
	_lambda17_ (_sender, object, self);
}


#line 114 "scroller-controller.vala"
static void _unity_launcher_scroller_controller_on_scroller_controller_closed_unity_launcher_scroller_child_controller_closed (UnityLauncherScrollerChildController* _sender, gpointer self) {
#line 264 "scroller-controller.c"
	unity_launcher_scroller_controller_on_scroller_controller_closed (self, _sender);
}


#line 70 "scroller-controller.vala"
static void unity_launcher_scroller_controller_handle_bamf_view_opened (UnityLauncherScrollerController* self, GObject* object) {
#line 70 "scroller-controller.vala"
	g_return_if_fail (self != NULL);
#line 70 "scroller-controller.vala"
	g_return_if_fail (object != NULL);
#line 275 "scroller-controller.c"
	g_return_if_fail (BAMF_IS_VIEW (object));
#line 73 "scroller-controller.vala"
	if (BAMF_IS_APPLICATION (object)) {
#line 279 "scroller-controller.c"
		GObject* _tmp0_;
		BamfApplication* app;
#line 75 "scroller-controller.vala"
		app = _g_object_ref0 ((_tmp0_ = object, BAMF_IS_APPLICATION (_tmp0_) ? ((BamfApplication*) _tmp0_) : NULL));
#line 77 "scroller-controller.vala"
		if (_vala_strcmp0 (bamf_application_get_desktop_file (app), "") == 0) {
#line 79 "scroller-controller.vala"
			g_debug ("scroller-controller.vala:79: no desktop file for this app");
#line 288 "scroller-controller.c"
			_g_object_unref0 (app);
#line 80 "scroller-controller.vala"
			return;
#line 292 "scroller-controller.c"
		}
#line 83 "scroller-controller.vala"
		g_signal_connect_object ((BamfView*) app, "user-visible-changed", (GCallback) __lambda17__bamf_view_user_visible_changed, self, 0);
#line 90 "scroller-controller.vala"
		if (bamf_view_user_visible ((BamfView*) app)) {
#line 298 "scroller-controller.c"
			char* desktop_file;
#line 92 "scroller-controller.vala"
			desktop_file = g_strdup (bamf_application_get_desktop_file (app));
#line 93 "scroller-controller.vala"
			if (desktop_file != NULL) {
#line 304 "scroller-controller.c"
				UnityLauncherApplicationController* controller;
#line 95 "scroller-controller.vala"
				controller = unity_launcher_scroller_controller_find_controller_by_desktop_file (self, desktop_file);
#line 96 "scroller-controller.vala"
				if (UNITY_LAUNCHER_IS_APPLICATION_CONTROLLER (controller)) {
#line 98 "scroller-controller.vala"
					unity_launcher_application_controller_attach_application (controller, app);
#line 312 "scroller-controller.c"
				} else {
					UnityLauncherLauncherChild* child;
					UnityLauncherApplicationController* _tmp1_;
#line 102 "scroller-controller.vala"
					child = g_object_ref_sink (unity_launcher_launcher_child_new ());
#line 103 "scroller-controller.vala"
					controller = (_tmp1_ = unity_launcher_application_controller_new (desktop_file, (UnityLauncherScrollerChild*) child), _g_object_unref0 (controller), _tmp1_);
#line 104 "scroller-controller.vala"
					unity_launcher_application_controller_attach_application (controller, app);
#line 105 "scroller-controller.vala"
					unity_launcher_scroller_model_add (self->priv->_model, (UnityLauncherScrollerChild*) child);
#line 106 "scroller-controller.vala"
					gee_abstract_collection_add ((GeeAbstractCollection*) self->priv->childcontrollers, (UnityLauncherScrollerChildController*) controller);
#line 107 "scroller-controller.vala"
					g_signal_connect_object ((UnityLauncherScrollerChildController*) controller, "closed", (GCallback) _unity_launcher_scroller_controller_on_scroller_controller_closed_unity_launcher_scroller_child_controller_closed, self, 0);
#line 328 "scroller-controller.c"
					_g_object_unref0 (child);
				}
				_g_object_unref0 (controller);
			}
			_g_free0 (desktop_file);
		}
		_g_object_unref0 (app);
	}
}


#line 114 "scroller-controller.vala"
static void unity_launcher_scroller_controller_on_scroller_controller_closed (UnityLauncherScrollerController* self, UnityLauncherScrollerChildController* controller) {
#line 114 "scroller-controller.vala"
	g_return_if_fail (self != NULL);
#line 114 "scroller-controller.vala"
	g_return_if_fail (controller != NULL);
#line 116 "scroller-controller.vala"
	if (UNITY_LAUNCHER_IS_APPLICATION_CONTROLLER (controller)) {
#line 118 "scroller-controller.vala"
		if (unity_launcher_scroller_child_controller_get_child (controller)->pin_type == UNITY_LAUNCHER_PIN_TYPE_UNPINNED) {
#line 120 "scroller-controller.vala"
			unity_launcher_scroller_model_remove (self->priv->_model, unity_launcher_scroller_child_controller_get_child (controller));
#line 121 "scroller-controller.vala"
			gee_abstract_collection_remove ((GeeAbstractCollection*) self->priv->childcontrollers, controller);
#line 354 "scroller-controller.c"
		}
	}
}


#line 126 "scroller-controller.vala"
static void unity_launcher_scroller_controller_build_favorites (UnityLauncherScrollerController* self) {
#line 126 "scroller-controller.vala"
	g_return_if_fail (self != NULL);
#line 364 "scroller-controller.c"
	{
		GeeArrayList* _tmp0_;
		GeeIterator* _tmp1_;
		GeeIterator* _uid_it;
		_uid_it = (_tmp1_ = gee_abstract_collection_iterator ((GeeAbstractCollection*) (_tmp0_ = unity_favorites_get_favorites (self->priv->favorites))), _g_object_unref0 (_tmp0_), _tmp1_);
#line 129 "scroller-controller.vala"
		while (TRUE) {
#line 372 "scroller-controller.c"
			char* uid;
			char* type;
			char* desktop_file;
			UnityLauncherApplicationController* controller;
#line 129 "scroller-controller.vala"
			if (!gee_iterator_next (_uid_it)) {
#line 129 "scroller-controller.vala"
				break;
#line 381 "scroller-controller.c"
			}
#line 129 "scroller-controller.vala"
			uid = (char*) gee_iterator_get (_uid_it);
#line 131 "scroller-controller.vala"
			type = unity_favorites_get_string (self->priv->favorites, uid, "type");
#line 132 "scroller-controller.vala"
			if (_vala_strcmp0 (type, "application") != 0) {
#line 389 "scroller-controller.c"
				_g_free0 (uid);
				_g_free0 (type);
#line 133 "scroller-controller.vala"
				continue;
#line 394 "scroller-controller.c"
			}
#line 135 "scroller-controller.vala"
			desktop_file = unity_favorites_get_string (self->priv->favorites, uid, "desktop_file");
#line 136 "scroller-controller.vala"
			if (!g_file_test (desktop_file, G_FILE_TEST_EXISTS)) {
#line 400 "scroller-controller.c"
				_g_free0 (uid);
				_g_free0 (type);
				_g_free0 (desktop_file);
#line 139 "scroller-controller.vala"
				continue;
#line 406 "scroller-controller.c"
			}
#line 142 "scroller-controller.vala"
			controller = unity_launcher_scroller_controller_find_controller_by_desktop_file (self, desktop_file);
#line 143 "scroller-controller.vala"
			if (!UNITY_LAUNCHER_IS_SCROLLER_CHILD_CONTROLLER (controller)) {
#line 412 "scroller-controller.c"
				UnityLauncherLauncherChild* child;
				UnityLauncherApplicationController* _tmp2_;
#line 145 "scroller-controller.vala"
				child = g_object_ref_sink (unity_launcher_launcher_child_new ());
#line 146 "scroller-controller.vala"
				controller = (_tmp2_ = unity_launcher_application_controller_new (desktop_file, (UnityLauncherScrollerChild*) child), _g_object_unref0 (controller), _tmp2_);
#line 147 "scroller-controller.vala"
				unity_launcher_scroller_model_add (self->priv->_model, (UnityLauncherScrollerChild*) child);
#line 148 "scroller-controller.vala"
				gee_abstract_collection_add ((GeeAbstractCollection*) self->priv->childcontrollers, (UnityLauncherScrollerChildController*) controller);
#line 149 "scroller-controller.vala"
				g_signal_connect_object ((UnityLauncherScrollerChildController*) controller, "closed", (GCallback) _unity_launcher_scroller_controller_on_scroller_controller_closed_unity_launcher_scroller_child_controller_closed, self, 0);
#line 425 "scroller-controller.c"
				_g_object_unref0 (child);
			}
			_g_free0 (uid);
			_g_free0 (type);
			_g_free0 (desktop_file);
			_g_object_unref0 (controller);
		}
		_g_object_unref0 (_uid_it);
	}
}


#line 154 "scroller-controller.vala"
static void unity_launcher_scroller_controller_on_favorite_added (UnityLauncherScrollerController* self, const char* uid) {
#line 440 "scroller-controller.c"
	char* desktop_file;
	UnityLauncherApplicationController* controller;
#line 154 "scroller-controller.vala"
	g_return_if_fail (self != NULL);
#line 154 "scroller-controller.vala"
	g_return_if_fail (uid != NULL);
#line 156 "scroller-controller.vala"
	desktop_file = unity_favorites_get_string (self->priv->favorites, uid, "desktop_file");
#line 157 "scroller-controller.vala"
	if (!g_file_test (desktop_file, G_FILE_TEST_EXISTS)) {
#line 451 "scroller-controller.c"
		_g_free0 (desktop_file);
#line 160 "scroller-controller.vala"
		return;
#line 455 "scroller-controller.c"
	}
#line 163 "scroller-controller.vala"
	controller = unity_launcher_scroller_controller_find_controller_by_desktop_file (self, desktop_file);
#line 164 "scroller-controller.vala"
	if (!UNITY_LAUNCHER_IS_SCROLLER_CHILD_CONTROLLER (controller)) {
#line 461 "scroller-controller.c"
		UnityLauncherLauncherChild* child;
		UnityLauncherApplicationController* _tmp0_;
#line 166 "scroller-controller.vala"
		child = g_object_ref_sink (unity_launcher_launcher_child_new ());
#line 167 "scroller-controller.vala"
		controller = (_tmp0_ = unity_launcher_application_controller_new (desktop_file, (UnityLauncherScrollerChild*) child), _g_object_unref0 (controller), _tmp0_);
#line 168 "scroller-controller.vala"
		unity_launcher_scroller_model_add (self->priv->_model, (UnityLauncherScrollerChild*) child);
#line 169 "scroller-controller.vala"
		gee_abstract_collection_add ((GeeAbstractCollection*) self->priv->childcontrollers, (UnityLauncherScrollerChildController*) controller);
#line 170 "scroller-controller.vala"
		g_signal_connect_object ((UnityLauncherScrollerChildController*) controller, "closed", (GCallback) _unity_launcher_scroller_controller_on_scroller_controller_closed_unity_launcher_scroller_child_controller_closed, self, 0);
#line 474 "scroller-controller.c"
		_g_object_unref0 (child);
	}
	_g_free0 (desktop_file);
	_g_object_unref0 (controller);
}


#line 174 "scroller-controller.vala"
void unity_launcher_scroller_controller_on_favorite_removed (UnityLauncherScrollerController* self, const char* uid) {
#line 174 "scroller-controller.vala"
	g_return_if_fail (self != NULL);
#line 174 "scroller-controller.vala"
	g_return_if_fail (uid != NULL);
#line 488 "scroller-controller.c"
}


#line 178 "scroller-controller.vala"
gboolean unity_launcher_scroller_controller_desktop_file_is_favorite (UnityLauncherScrollerController* self, const char* desktop_file) {
#line 494 "scroller-controller.c"
	gboolean result = FALSE;
	UnityFavorites* favorites;
	GeeArrayList* favorite_list;
#line 178 "scroller-controller.vala"
	g_return_val_if_fail (self != NULL, FALSE);
#line 178 "scroller-controller.vala"
	g_return_val_if_fail (desktop_file != NULL, FALSE);
#line 180 "scroller-controller.vala"
	favorites = unity_favorites_get_default ();
#line 182 "scroller-controller.vala"
	favorite_list = unity_favorites_get_favorites (favorites);
#line 506 "scroller-controller.c"
	{
		GeeIterator* _uid_it;
		_uid_it = gee_abstract_collection_iterator ((GeeAbstractCollection*) favorite_list);
#line 183 "scroller-controller.vala"
		while (TRUE) {
#line 512 "scroller-controller.c"
			char* uid;
			char* type;
			char* fav_desktop_file;
#line 183 "scroller-controller.vala"
			if (!gee_iterator_next (_uid_it)) {
#line 183 "scroller-controller.vala"
				break;
#line 520 "scroller-controller.c"
			}
#line 183 "scroller-controller.vala"
			uid = (char*) gee_iterator_get (_uid_it);
#line 185 "scroller-controller.vala"
			type = unity_favorites_get_string (favorites, uid, "type");
#line 186 "scroller-controller.vala"
			if (_vala_strcmp0 (type, "application") != 0) {
#line 528 "scroller-controller.c"
				_g_free0 (uid);
				_g_free0 (type);
#line 187 "scroller-controller.vala"
				continue;
#line 533 "scroller-controller.c"
			}
#line 189 "scroller-controller.vala"
			fav_desktop_file = unity_favorites_get_string (favorites, uid, "desktop_file");
#line 190 "scroller-controller.vala"
			if (_vala_strcmp0 (desktop_file, fav_desktop_file) == 0) {
#line 539 "scroller-controller.c"
				result = TRUE;
				_g_free0 (uid);
				_g_free0 (type);
				_g_free0 (fav_desktop_file);
				_g_object_unref0 (_uid_it);
				_g_object_unref0 (favorites);
				_g_object_unref0 (favorite_list);
#line 192 "scroller-controller.vala"
				return result;
#line 549 "scroller-controller.c"
			}
			_g_free0 (uid);
			_g_free0 (type);
			_g_free0 (fav_desktop_file);
		}
		_g_object_unref0 (_uid_it);
	}
	result = FALSE;
	_g_object_unref0 (favorites);
	_g_object_unref0 (favorite_list);
#line 196 "scroller-controller.vala"
	return result;
#line 562 "scroller-controller.c"
}


#line 199 "scroller-controller.vala"
static UnityLauncherApplicationController* unity_launcher_scroller_controller_find_controller_by_desktop_file (UnityLauncherScrollerController* self, const char* desktop_file) {
#line 568 "scroller-controller.c"
	UnityLauncherApplicationController* result = NULL;
#line 199 "scroller-controller.vala"
	g_return_val_if_fail (self != NULL, NULL);
#line 199 "scroller-controller.vala"
	g_return_val_if_fail (desktop_file != NULL, NULL);
#line 574 "scroller-controller.c"
	{
		GeeIterator* _controller_it;
		_controller_it = gee_abstract_collection_iterator ((GeeAbstractCollection*) self->priv->childcontrollers);
#line 201 "scroller-controller.vala"
		while (TRUE) {
#line 580 "scroller-controller.c"
			UnityLauncherScrollerChildController* controller;
#line 201 "scroller-controller.vala"
			if (!gee_iterator_next (_controller_it)) {
#line 201 "scroller-controller.vala"
				break;
#line 586 "scroller-controller.c"
			}
#line 201 "scroller-controller.vala"
			controller = (UnityLauncherScrollerChildController*) gee_iterator_get (_controller_it);
#line 203 "scroller-controller.vala"
			if (UNITY_LAUNCHER_IS_APPLICATION_CONTROLLER (controller)) {
#line 592 "scroller-controller.c"
				UnityLauncherScrollerChildController* _tmp0_;
#line 205 "scroller-controller.vala"
				if (_vala_strcmp0 (unity_launcher_application_controller_get_desktop_file ((_tmp0_ = controller, UNITY_LAUNCHER_IS_APPLICATION_CONTROLLER (_tmp0_) ? ((UnityLauncherApplicationController*) _tmp0_) : NULL)), desktop_file) == 0) {
#line 596 "scroller-controller.c"
					UnityLauncherScrollerChildController* _tmp1_;
					result = _g_object_ref0 ((_tmp1_ = controller, UNITY_LAUNCHER_IS_APPLICATION_CONTROLLER (_tmp1_) ? ((UnityLauncherApplicationController*) _tmp1_) : NULL));
					_g_object_unref0 (controller);
					_g_object_unref0 (_controller_it);
#line 207 "scroller-controller.vala"
					return result;
#line 603 "scroller-controller.c"
				}
			}
			_g_object_unref0 (controller);
		}
		_g_object_unref0 (_controller_it);
	}
	result = NULL;
#line 211 "scroller-controller.vala"
	return result;
#line 613 "scroller-controller.c"
}


#line 233 "scroller-controller.vala"
static void _unity_launcher_scroller_controller_on_unity_drag_motion_unity_drag_controller_drag_motion (UnityDragController* _sender, UnityDragModel* model, float x, float y, gpointer self) {
#line 619 "scroller-controller.c"
	unity_launcher_scroller_controller_on_unity_drag_motion (self, model, x, y);
}


#line 262 "scroller-controller.vala"
static void _unity_launcher_scroller_controller_on_unity_drag_drop_unity_drag_controller_drag_drop (UnityDragController* _sender, UnityDragModel* model, float x, float y, gpointer self) {
#line 626 "scroller-controller.c"
	unity_launcher_scroller_controller_on_unity_drag_drop (self, model, x, y);
}


#line 217 "scroller-controller.vala"
static void unity_launcher_scroller_controller_on_unity_drag_start (UnityLauncherScrollerController* self, UnityDragModel* drag_model) {
#line 633 "scroller-controller.c"
	UnityDragController* drag_controller;
	UnityDragModel* _tmp0_;
	gboolean _tmp1_;
#line 217 "scroller-controller.vala"
	g_return_if_fail (self != NULL);
#line 217 "scroller-controller.vala"
	g_return_if_fail (drag_model != NULL);
#line 219 "scroller-controller.vala"
	drag_controller = _g_object_ref0 (unity_drag_controller_get_default ());
#line 221 "scroller-controller.vala"
	g_signal_connect_object (drag_controller, "drag-motion", (GCallback) _unity_launcher_scroller_controller_on_unity_drag_motion_unity_drag_controller_drag_motion, self, 0);
#line 222 "scroller-controller.vala"
	g_signal_connect_object (drag_controller, "drag-drop", (GCallback) _unity_launcher_scroller_controller_on_unity_drag_drop_unity_drag_controller_drag_drop, self, 0);
#line 225 "scroller-controller.vala"
	if ((_tmp1_ = UNITY_LAUNCHER_IS_SCROLLER_CHILD_CONTROLLER (_tmp0_ = unity_drag_controller_get_drag_model (drag_controller)), _g_object_unref0 (_tmp0_), _tmp1_)) {
#line 649 "scroller-controller.c"
		UnityLauncherScrollerChildController* _tmp3_;
		UnityDragModel* _tmp2_;
		UnityLauncherScrollerChild* _tmp4_;
		UnityLauncherScrollerChild* child;
#line 227 "scroller-controller.vala"
		child = (_tmp4_ = _g_object_ref0 (unity_launcher_scroller_child_controller_get_child (_tmp3_ = (_tmp2_ = unity_drag_controller_get_drag_model (drag_controller), UNITY_LAUNCHER_IS_SCROLLER_CHILD_CONTROLLER (_tmp2_) ? ((UnityLauncherScrollerChildController*) _tmp2_) : NULL))), _g_object_unref0 (_tmp3_), _tmp4_);
#line 228 "scroller-controller.vala"
		clutter_actor_set_opacity ((ClutterActor*) child, (guint8) 0);
#line 229 "scroller-controller.vala"
		clutter_actor_queue_redraw ((ClutterActor*) self->priv->_view);
#line 660 "scroller-controller.c"
		_g_object_unref0 (child);
	}
	_g_object_unref0 (drag_controller);
}


#line 233 "scroller-controller.vala"
static void unity_launcher_scroller_controller_on_unity_drag_motion (UnityLauncherScrollerController* self, UnityDragModel* drag_model, float x, float y) {
#line 669 "scroller-controller.c"
	UnityDragController* drag_controller;
	UnityDragModel* _tmp0_;
	gboolean _tmp1_;
	UnityLauncherScrollerChildController* _tmp3_;
	UnityDragModel* _tmp2_;
	UnityLauncherScrollerChild* _tmp4_;
	UnityLauncherScrollerChild* retcont;
#line 233 "scroller-controller.vala"
	g_return_if_fail (self != NULL);
#line 233 "scroller-controller.vala"
	g_return_if_fail (drag_model != NULL);
#line 235 "scroller-controller.vala"
	drag_controller = _g_object_ref0 (unity_drag_controller_get_default ());
#line 237 "scroller-controller.vala"
	if ((_tmp1_ = !UNITY_LAUNCHER_IS_SCROLLER_CHILD_CONTROLLER (_tmp0_ = unity_drag_controller_get_drag_model (drag_controller)), _g_object_unref0 (_tmp0_), _tmp1_)) {
#line 685 "scroller-controller.c"
		_g_object_unref0 (drag_controller);
#line 239 "scroller-controller.vala"
		return;
#line 689 "scroller-controller.c"
	}
#line 241 "scroller-controller.vala"
	retcont = (_tmp4_ = _g_object_ref0 (unity_launcher_scroller_child_controller_get_child (_tmp3_ = (_tmp2_ = unity_drag_controller_get_drag_model (drag_controller), UNITY_LAUNCHER_IS_SCROLLER_CHILD_CONTROLLER (_tmp2_) ? ((UnityLauncherScrollerChildController*) _tmp2_) : NULL))), _g_object_unref0 (_tmp3_), _tmp4_);
#line 243 "scroller-controller.vala"
	if (x > (clutter_actor_get_width ((ClutterActor*) self->priv->_view) + UNITY_LAUNCHER_SCROLLER_CONTROLLER_DRAG_SAFE_ZONE)) {
#line 246 "scroller-controller.vala"
		unity_launcher_scroller_model_remove (self->priv->_model, retcont);
#line 697 "scroller-controller.c"
	} else {
		gint model_index;
#line 252 "scroller-controller.vala"
		model_index = unity_launcher_scroller_view_get_model_index_at_y_pos (self->priv->_view, y);
#line 253 "scroller-controller.vala"
		if (unity_launcher_scroller_model_contains (self->priv->_model, retcont)) {
#line 254 "scroller-controller.vala"
			unity_launcher_scroller_model_move (self->priv->_model, retcont, MAX (model_index - 1, 0));
#line 706 "scroller-controller.c"
		} else {
#line 256 "scroller-controller.vala"
			unity_launcher_scroller_model_insert (self->priv->_model, retcont, MAX (model_index - 1, 0));
#line 710 "scroller-controller.c"
		}
#line 258 "scroller-controller.vala"
		clutter_actor_queue_redraw ((ClutterActor*) self->priv->_view);
#line 714 "scroller-controller.c"
	}
	_g_object_unref0 (drag_controller);
	_g_object_unref0 (retcont);
}


#line 262 "scroller-controller.vala"
static void unity_launcher_scroller_controller_on_unity_drag_drop (UnityLauncherScrollerController* self, UnityDragModel* drag_model, float x, float y) {
#line 723 "scroller-controller.c"
	UnityDragController* drag_controller;
	UnityDragModel* _tmp0_;
	gboolean _tmp1_;
	UnityDragModel* _tmp2_;
	UnityLauncherScrollerChildController* model_controller;
	UnityLauncherScrollerChild* retcont;
	guint _tmp3_;
	guint _tmp4_;
#line 262 "scroller-controller.vala"
	g_return_if_fail (self != NULL);
#line 262 "scroller-controller.vala"
	g_return_if_fail (drag_model != NULL);
#line 264 "scroller-controller.vala"
	drag_controller = _g_object_ref0 (unity_drag_controller_get_default ());
#line 266 "scroller-controller.vala"
	if ((_tmp1_ = !UNITY_LAUNCHER_IS_SCROLLER_CHILD_CONTROLLER (_tmp0_ = unity_drag_controller_get_drag_model (drag_controller)), _g_object_unref0 (_tmp0_), _tmp1_)) {
#line 740 "scroller-controller.c"
		_g_object_unref0 (drag_controller);
#line 268 "scroller-controller.vala"
		return;
#line 744 "scroller-controller.c"
	}
#line 270 "scroller-controller.vala"
	model_controller = (_tmp2_ = unity_drag_controller_get_drag_model (drag_controller), UNITY_LAUNCHER_IS_SCROLLER_CHILD_CONTROLLER (_tmp2_) ? ((UnityLauncherScrollerChildController*) _tmp2_) : NULL);
#line 271 "scroller-controller.vala"
	retcont = _g_object_ref0 (unity_launcher_scroller_child_controller_get_child (model_controller));
#line 273 "scroller-controller.vala"
	if (x > clutter_actor_get_width ((ClutterActor*) self->priv->_view)) {
#line 276 "scroller-controller.vala"
		if (unity_launcher_scroller_model_contains (self->priv->_model, retcont)) {
#line 277 "scroller-controller.vala"
			unity_launcher_scroller_model_remove (self->priv->_model, retcont);
#line 756 "scroller-controller.c"
		}
#line 279 "scroller-controller.vala"
		if (gee_abstract_collection_contains ((GeeAbstractCollection*) self->priv->childcontrollers, model_controller)) {
#line 280 "scroller-controller.vala"
			gee_abstract_collection_remove ((GeeAbstractCollection*) self->priv->childcontrollers, model_controller);
#line 762 "scroller-controller.c"
		}
	}
#line 283 "scroller-controller.vala"
	clutter_actor_set_opacity ((ClutterActor*) retcont, (guint8) 255);
#line 285 "scroller-controller.vala"
	g_signal_parse_name ("drag-motion", UNITY_DRAG_TYPE_CONTROLLER, &_tmp3_, NULL, FALSE);
#line 285 "scroller-controller.vala"
	g_signal_handlers_disconnect_matched (drag_controller, G_SIGNAL_MATCH_ID | G_SIGNAL_MATCH_FUNC | G_SIGNAL_MATCH_DATA, _tmp3_, 0, NULL, (GCallback) _unity_launcher_scroller_controller_on_unity_drag_motion_unity_drag_controller_drag_motion, self);
#line 286 "scroller-controller.vala"
	g_signal_parse_name ("drag-drop", UNITY_DRAG_TYPE_CONTROLLER, &_tmp4_, NULL, FALSE);
#line 286 "scroller-controller.vala"
	g_signal_handlers_disconnect_matched (drag_controller, G_SIGNAL_MATCH_ID | G_SIGNAL_MATCH_FUNC | G_SIGNAL_MATCH_DATA, _tmp4_, 0, NULL, (GCallback) _unity_launcher_scroller_controller_on_unity_drag_drop_unity_drag_controller_drag_drop, self);
#line 775 "scroller-controller.c"
	_g_object_unref0 (drag_controller);
	_g_object_unref0 (model_controller);
	_g_object_unref0 (retcont);
}


UnityLauncherScrollerModel* unity_launcher_scroller_controller_get_model (UnityLauncherScrollerController* self) {
	UnityLauncherScrollerModel* result;
	g_return_val_if_fail (self != NULL, NULL);
	result = self->priv->_model;
#line 25 "scroller-controller.vala"
	return result;
#line 788 "scroller-controller.c"
}


static void unity_launcher_scroller_controller_set_model (UnityLauncherScrollerController* self, UnityLauncherScrollerModel* value) {
	UnityLauncherScrollerModel* _tmp0_;
	g_return_if_fail (self != NULL);
	self->priv->_model = (_tmp0_ = _g_object_ref0 (value), _g_object_unref0 (self->priv->_model), _tmp0_);
	g_object_notify ((GObject *) self, "model");
}


UnityLauncherScrollerView* unity_launcher_scroller_controller_get_view (UnityLauncherScrollerController* self) {
	UnityLauncherScrollerView* result;
	g_return_val_if_fail (self != NULL, NULL);
	result = self->priv->_view;
#line 26 "scroller-controller.vala"
	return result;
#line 806 "scroller-controller.c"
}


static void unity_launcher_scroller_controller_set_view (UnityLauncherScrollerController* self, UnityLauncherScrollerView* value) {
	UnityLauncherScrollerView* _tmp0_;
	g_return_if_fail (self != NULL);
	self->priv->_view = (_tmp0_ = _g_object_ref0 (value), _g_object_unref0 (self->priv->_view), _tmp0_);
	g_object_notify ((GObject *) self, "view");
}


#line 154 "scroller-controller.vala"
static void _unity_launcher_scroller_controller_on_favorite_added_unity_favorites_favorite_added (UnityFavorites* _sender, const char* uid, gpointer self) {
#line 820 "scroller-controller.c"
	unity_launcher_scroller_controller_on_favorite_added (self, uid);
}


#line 70 "scroller-controller.vala"
static void _unity_launcher_scroller_controller_handle_bamf_view_opened_bamf_matcher_view_opened (BamfMatcher* _sender, GObject* object, gpointer self) {
#line 827 "scroller-controller.c"
	unity_launcher_scroller_controller_handle_bamf_view_opened (self, object);
}


#line 217 "scroller-controller.vala"
static void _unity_launcher_scroller_controller_on_unity_drag_start_unity_drag_controller_drag_start (UnityDragController* _sender, UnityDragModel* model, gpointer self) {
#line 834 "scroller-controller.c"
	unity_launcher_scroller_controller_on_unity_drag_start (self, model);
}


static GObject * unity_launcher_scroller_controller_constructor (GType type, guint n_construct_properties, GObjectConstructParam * construct_properties) {
	GObject * obj;
	GObjectClass * parent_class;
	UnityLauncherScrollerController * self;
	parent_class = G_OBJECT_CLASS (unity_launcher_scroller_controller_parent_class);
	obj = parent_class->constructor (type, n_construct_properties, construct_properties);
	self = UNITY_LAUNCHER_SCROLLER_CONTROLLER (obj);
	{
		GeeArrayList* _tmp0_;
		BamfMatcher* _tmp1_;
		UnityFavorites* _tmp2_;
		UnityDragController* drag_controller;
#line 44 "scroller-controller.vala"
		self->priv->childcontrollers = (_tmp0_ = gee_array_list_new (UNITY_LAUNCHER_TYPE_SCROLLER_CHILD_CONTROLLER, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL), _g_object_unref0 (self->priv->childcontrollers), _tmp0_);
#line 46 "scroller-controller.vala"
		self->priv->matcher = (_tmp1_ = _g_object_ref0 (bamf_matcher_get_default ()), _g_object_unref0 (self->priv->matcher), _tmp1_);
#line 47 "scroller-controller.vala"
		self->priv->favorites = (_tmp2_ = unity_favorites_get_default (), _g_object_unref0 (self->priv->favorites), _tmp2_);
#line 48 "scroller-controller.vala"
		g_signal_connect_object (self->priv->favorites, "favorite-added", (GCallback) _unity_launcher_scroller_controller_on_favorite_added_unity_favorites_favorite_added, self, 0);
#line 49 "scroller-controller.vala"
		g_signal_connect_object (self->priv->matcher, "view-opened", (GCallback) _unity_launcher_scroller_controller_handle_bamf_view_opened_bamf_matcher_view_opened, self, 0);
#line 51 "scroller-controller.vala"
		unity_launcher_scroller_controller_build_favorites (self);
#line 863 "scroller-controller.c"
		{
			GList* object_collection;
			GList* object_it;
#line 53 "scroller-controller.vala"
			object_collection = (GList*) bamf_matcher_get_running_applications (self->priv->matcher);
#line 869 "scroller-controller.c"
			for (object_it = object_collection; object_it != NULL; object_it = object_it->next) {
				GObject* object;
#line 53 "scroller-controller.vala"
				object = _g_object_ref0 ((GObject*) ((BamfView*) object_it->data));
#line 874 "scroller-controller.c"
				{
#line 55 "scroller-controller.vala"
					if (BAMF_IS_VIEW (object)) {
#line 57 "scroller-controller.vala"
						unity_launcher_scroller_controller_handle_bamf_view_opened (self, object);
#line 880 "scroller-controller.c"
					} else {
#line 61 "scroller-controller.vala"
						g_error ("scroller-controller.vala:61: Bamf returned a strange object");
#line 884 "scroller-controller.c"
					}
					_g_object_unref0 (object);
				}
			}
		}
#line 66 "scroller-controller.vala"
		drag_controller = _g_object_ref0 (unity_drag_controller_get_default ());
#line 67 "scroller-controller.vala"
		g_signal_connect_object (drag_controller, "drag-start", (GCallback) _unity_launcher_scroller_controller_on_unity_drag_start_unity_drag_controller_drag_start, self, 0);
#line 894 "scroller-controller.c"
		_g_object_unref0 (drag_controller);
	}
	return obj;
}


static void unity_launcher_scroller_controller_class_init (UnityLauncherScrollerControllerClass * klass) {
	unity_launcher_scroller_controller_parent_class = g_type_class_peek_parent (klass);
	g_type_class_add_private (klass, sizeof (UnityLauncherScrollerControllerPrivate));
	G_OBJECT_CLASS (klass)->get_property = unity_launcher_scroller_controller_get_property;
	G_OBJECT_CLASS (klass)->set_property = unity_launcher_scroller_controller_set_property;
	G_OBJECT_CLASS (klass)->constructor = unity_launcher_scroller_controller_constructor;
	G_OBJECT_CLASS (klass)->finalize = unity_launcher_scroller_controller_finalize;
	g_object_class_install_property (G_OBJECT_CLASS (klass), UNITY_LAUNCHER_SCROLLER_CONTROLLER_MODEL, g_param_spec_object ("model", "model", "model", UNITY_LAUNCHER_TYPE_SCROLLER_MODEL, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE | G_PARAM_CONSTRUCT_ONLY));
	g_object_class_install_property (G_OBJECT_CLASS (klass), UNITY_LAUNCHER_SCROLLER_CONTROLLER_VIEW, g_param_spec_object ("view", "view", "view", UNITY_LAUNCHER_TYPE_SCROLLER_VIEW, G_PARAM_STATIC_NAME | G_PARAM_STATIC_NICK | G_PARAM_STATIC_BLURB | G_PARAM_READABLE | G_PARAM_WRITABLE | G_PARAM_CONSTRUCT_ONLY));
}


static void unity_launcher_scroller_controller_instance_init (UnityLauncherScrollerController * self) {
	self->priv = UNITY_LAUNCHER_SCROLLER_CONTROLLER_GET_PRIVATE (self);
}


static void unity_launcher_scroller_controller_finalize (GObject* obj) {
	UnityLauncherScrollerController * self;
	self = UNITY_LAUNCHER_SCROLLER_CONTROLLER (obj);
	_g_object_unref0 (self->priv->_model);
	_g_object_unref0 (self->priv->_view);
	_g_object_unref0 (self->priv->childcontrollers);
	_g_object_unref0 (self->priv->matcher);
	_g_object_unref0 (self->priv->favorites);
	G_OBJECT_CLASS (unity_launcher_scroller_controller_parent_class)->finalize (obj);
}


GType unity_launcher_scroller_controller_get_type (void) {
	static volatile gsize unity_launcher_scroller_controller_type_id__volatile = 0;
	if (g_once_init_enter (&unity_launcher_scroller_controller_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (UnityLauncherScrollerControllerClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) unity_launcher_scroller_controller_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (UnityLauncherScrollerController), 0, (GInstanceInitFunc) unity_launcher_scroller_controller_instance_init, NULL };
		GType unity_launcher_scroller_controller_type_id;
		unity_launcher_scroller_controller_type_id = g_type_register_static (G_TYPE_OBJECT, "UnityLauncherScrollerController", &g_define_type_info, 0);
		g_once_init_leave (&unity_launcher_scroller_controller_type_id__volatile, unity_launcher_scroller_controller_type_id);
	}
	return unity_launcher_scroller_controller_type_id__volatile;
}


static void unity_launcher_scroller_controller_get_property (GObject * object, guint property_id, GValue * value, GParamSpec * pspec) {
	UnityLauncherScrollerController * self;
	self = UNITY_LAUNCHER_SCROLLER_CONTROLLER (object);
	switch (property_id) {
		case UNITY_LAUNCHER_SCROLLER_CONTROLLER_MODEL:
		g_value_set_object (value, unity_launcher_scroller_controller_get_model (self));
		break;
		case UNITY_LAUNCHER_SCROLLER_CONTROLLER_VIEW:
		g_value_set_object (value, unity_launcher_scroller_controller_get_view (self));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static void unity_launcher_scroller_controller_set_property (GObject * object, guint property_id, const GValue * value, GParamSpec * pspec) {
	UnityLauncherScrollerController * self;
	self = UNITY_LAUNCHER_SCROLLER_CONTROLLER (object);
	switch (property_id) {
		case UNITY_LAUNCHER_SCROLLER_CONTROLLER_MODEL:
		unity_launcher_scroller_controller_set_model (self, g_value_get_object (value));
		break;
		case UNITY_LAUNCHER_SCROLLER_CONTROLLER_VIEW:
		unity_launcher_scroller_controller_set_view (self, g_value_get_object (value));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}


static int _vala_strcmp0 (const char * str1, const char * str2) {
	if (str1 == NULL) {
		return -(str1 != str2);
	}
	if (str2 == NULL) {
		return str1 != str2;
	}
	return strcmp (str1, str2);
}




